{% extends "base.html.jinja" %}
{% block title %}{{ s.name|e }} | {{ super() }}{% endblock %}
{% block script %}<script src="/static/table-sort.js"></script>{% endblock %}
{% block content %}

<h1>{{ s.name|e }}</h1>

<table class="table-sort table-arrows">
<tr>
    <th>Product</th>
    <th>Huidige prijs</th>
    <th>Gemiddelde prijs</th>
    <th>Laagste prijs</th>
    <th>Hoogste prijs</th>
{% if show_variance %}
    <th>Variatie</th>
{% endif %}
    <th>Bijgehouden sinds</th>
    <th>Website verkoper</th>
</tr>
{% for offer in offers %}
<tr>
    <td><a href="/product/{{ offer.product.product_code|e }}">{{ offer.product.name|e }}</a></td>
{% if offer.get_current_price().on_sale %}
    <td class="sale">{{ "€%.2f" | format(offer.get_current_price().discount_price)  }} ({{ offer.get_current_price().datetime.strftime("%Y-%m-%d") }}) Korting!</td>
{% elif offer.get_current_price().normal_price == -1 %}
    <td>Geen actuele prijs beschikbaar ({{ offer.get_current_price().datetime.strftime("%Y-%m-%d") }})</td>
{% else %}
    <td>{{ "€%.2f" | format(offer.get_current_price().normal_price) }} ({{ offer.get_current_price().datetime.strftime("%Y-%m-%d") }})</td>
{% endif %}
    <td>{{ "€%.2f" | format(offer.get_average_price()) }}</td>
    <td>{{ "€%.2f" | format(offer.get_lowest_price()) }}</td>
    <td>{{ "€%.2f" | format(offer.get_highest_price()) }}</td>
{% if show_variance %}
    <td>{{ "%.2f" | format(offer.get_price_standard_deviation()) }}</td>
{% endif %}
    <td>{{ offer.time_added.strftime("%Y-%m-%d") }}</td>
    <td><a target="_blank" href="{{ offer.url }}">{{ offer.webshop.hostname }}</a></td>
</tr>
{% endfor %}
</table>
{% endblock %}
